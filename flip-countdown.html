<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="moment-import.html">
<link rel="import" href="moment-import.html">


<!--
A flip clock, timer and countdown made with Polymer

##### Examples

    <flip-countdown></flip-countdown>

    <flip-countdown display-mode="timer" show-buttons></flip-countdown>

    <flip-countdown display-mode="countdown" start-from="20" show-buttons></flip-countdown>

@demo
@element flip-countdown
@homepage http://Granze.github.io/flip-countdown
@author Maurizio Mangione

-->

<dom-module id="flip-countdown">
  <style>
    :host {
      display: block;
    }
    #clock {
      font-family: Arial, Verdana, sans-serif;
      font-weight: bold;
      font-size: var(--digits-size, 50px);
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #clock li {
        display: inline-block;
    }

    #clock em {
        display: block;
        text-align: center;
        font-size: 13px;
        line-height: 18px;
    }

    #clock .num {
      position: relative;
      display: block;
      padding: 5px 15px;
      border-radius: 4px;
      color: var(--digits-color, #fff);
      box-shadow: var(--box-shadow, 1px 1px 1px #555);
      background-color: var(--bg-color, #333);
    }

    #clock .num:after {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      width: 100%;
      height: 3px;
      background-color: #111;
    }

     </style>
  <template>
    <ul id="clock">
      
        <li hidden$="[[hideYears]]">
           <span class="num" id="years0">[[years]]</span>
           <em>[[stringYear]]</em>
        </li>
    
        <li hidden$="[[hideMonths]]">
          <span class="num" id="months0">[[months]]</span>
          <em>[[stringMonth]]</em>
        </li>

        <li hidden$="[[hideDays]]">
             <span class="num" id="days0">[[days]]</span>
            <em>[[stringDay]]</em>
        </li>

        <li hidden$="[[hideHours]]">
             <span class="num" id="hours0">[[hours]]</span>
            <em>[[stringHour]]</em>
        </li>

        <li hidden$="[[hideMinutes]]">
          <span class="num" id="minutes0">[[minutes]] </span>      
            <em>[[stringMinute]]</em>
        </li>

        <li hidden$="[[hideSeconds]]">
            <span class="num" id="seconds0">[[seconds]]</span>
            <em>[[stringSecond]]</em>
        </li>
     </ul>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'flip-countdown',
    /***
     * @private
     * @type String
     * @default '000000'
     */
    minutes: 0,
    hours: 0,
    days: 0,
    years: 0,
    months: 0,

    /***
     * @private
     * @default null
     */
    timer: null,
    /***
     * @private
     * @type Boolean
     * @default false
     */
    isRunning: false,

    properties: {
      /**
       * Set the flip clock mode. Possible values are 'timer' and 'countdown'.
       * A clock will be displayed if no value is specified.
       *
       * @attribute displayMode
       * @type String
       * @default
       */
      displayMode: {
        type: String
      },
      /**
       * Show the command buttons to start, stop and reset a timer or a countdown
       *
       * @attribute showButtons
       * @type Boolean
       * @default false
       */
      showButtons: {
        type: Boolean,
        value: false
      },
      /**
       * Hide the hour digits in the counter, timer and countdown
       *
       * @attribute hideHours
       * @type Boolean
       * @default false
       */
      hideHours: {
        type: Boolean,
        value: false
      },
      hideSeconds: {
        type: Boolean,
        value: false
      },
      hideMinutes: {
        type: Boolean,
        value: false
      },
       hideDays: {
        type: Boolean,
        value: false
      },
       hideMonths: {
        type: Boolean,
        value: false
      },
       hideYears: {
        type: Boolean,
        value: false
      },

        /**
       * Starting minutes for the countdown
       *
       * @attribute startFrom
       * @type Number
       * @default null
       */
      startFrom: {
        type: Number,
        value: null
      },
    },
    /**
     * The `_createClock` method start a clock that display the current time.
     *
     * @method _createClock
     * @private
     */
    _createClock: function() {
      this.time = moment().format('YYMMDDHHmmss');
      this.async(this._createClock, 5);
    },
    /**
     * The `_createTimer` method create a timer
     *
     * @method _createTimer
     * @private
     */
    _createTimer: function() {
      if(this.isRunning) {
      }
    },
    /**
     * The `_createCountdown` method create a countdown
     *
     * @method _createCountdown
     * @private
     */
    _createCountdown: function() {

        this.current = moment();
   

        var diff = moment.preciseDiff(this.end, this.current, true)

        this.years   = this._format(diff.years);
        this.months  = this._format(diff.months);
        this.days    = this._format(diff.days);
        this.hours   = this._format(diff.hours);
        this.minutes = this._format(diff.minutes);
        this.seconds = this._format(diff.seconds);

        this.hideYears  = diff.years == 0 ? true : false;
        this.hideMonths = diff.months == 0 && diff.years == 0 ? true : false;
        this.hideDays   = diff.days == 0   && diff.months == 0 && diff.years == 0 ? true : false ;

        this.stringYear  = diff.years > 1 ? "Jahre" : "Jahr";
        this.stringMonth = diff.months > 1 ? "Monate" : "Monat";
        this.stringDay   = diff.days > 1 ? "Tage" : "Tag";
        this.stringHour   = diff.days > 1 ? "Stunden" : "Stunde";
        this.stringMinute  = diff.minutes > 1 ? "Minuten" : "Minute";
        this.stringSecond  = diff.seconds > 1 ? "Sekunden" : "Sekunde";

        this.async(this._createCountdown, 1000);
    },

    _format: function(d) {

        if ( d < 10 ) {
    
            return "0" + d ;

        } else {
        
            return d;
        }
    },

    /**
     * The `_startCount` method starts the timer or the countdown
     *
     * @method _startCount
     * @private
     */
    _startCount: function() { 
        this.end     = moment( this.startFrom );
        this._createCountdown()
   },
    /**
     * The `_stopCount` stop the running timer or countdown
     *
     * @method _stopCount
     * @private
     */
    _stopCount: function() {
      this.isRunning = false;
    },

    ready: function() {

      this._startCount();
    }
  });
</script>
